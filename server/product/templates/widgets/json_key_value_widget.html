<div id="json-widget-{{ widget.name }}" style="display: flex; flex-direction: column; row-gap: 6px; width: 381px">
    {% for pair in widget.pairs %}
    	<div class="pair">
            <input type="text" name="{{ widget.name }}_key" value="{{ pair.key }}" placeholder="attribute">
            <input type="text" name="{{ widget.name }}_value" value="{{ pair.value }}" placeholder="value">
            <input type="button" class="remove-pair-btn" value="X"/>
        </div>
    {% endfor %}
    <input type="button" class="add-pair" value="ADD"/>
</div>
<script>
    (function() {
        const root = document.getElementById("json-widget-{{ widget.name }}")
        root.querySelector('.add-pair').addEventListener('click', () => {
            const div = document.createElement('div')
            div.classList.add('pair')
            div.innerHTML = `
                <input type="text" name="{{ widget.name }}_key" value="{{ pair.key }}" placeholder="attribute">
                <input type="text" name="{{ widget.name }}_value" value="{{ pair.value }}" placeholder="value">
                <input type="button" class="remove-pair-btn" value="X"/>
            `
            root.insertBefore(div, root.querySelector('.add-pair'))
        })

        root.addEventListener('click', (event) => {
            if (event.target.classList.contains('remove-pair-btn')) {
                event.target.closest('.pair').remove()
            }
        })
    })()
</script>